2022-02-14 09:22:42,848 INFO  ==============================================================
2022-02-14 09:22:42,849 INFO  Id:    SoftwareManagement.sm_mapper_fail_and_reconnect
2022-02-14 09:22:42,850 INFO  Dir:   software_management_end_to_end/
2022-02-14 09:22:42,850 INFO  Title: Validate the tedge-mapper-sm-c8y for receiving the last message on restart
2022-02-14 09:22:42,851 DEBUG Execution order hint: 0.0
2022-02-14 09:22:42,851 INFO  ==============================================================
2022-02-14 09:22:42,972 INFO  Restarting mosquitto too frequently in the last 10 seconds. It was only up for 3 seconds
2022-02-14 09:22:42,973 INFO  Delaying execution by 8 seconds
2022-02-14 09:22:50,983 DEBUG Process parameters for sudo<tedge_connect_c8y>
  command line : /usr/bin/sudo /usr/bin/tedge connect c8y
    arg #1     : /usr/bin/tedge
    arg #2     : connect
    arg #3     : c8y
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_connect_c8y.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_connect_c8y.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:22:50,992 DEBUG Waiting up to 600 secs for process sudo<tedge_connect_c8y> (pid 17065)
2022-02-14 09:23:02,165 INFO  Executed sudo<tedge_connect_c8y>, exit status 0, duration 11 secs
2022-02-14 09:23:02,174 DEBUG Process parameters for sudo<install>
  command line : /usr/bin/sudo /usr/bin/apt-get install rolldice
    arg #1     : /usr/bin/apt-get
    arg #2     : install
    arg #3     : rolldice
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/install.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/install.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:23:02,181 DEBUG Waiting up to 600 secs for process sudo<install> (pid 17215)
2022-02-14 09:23:25,490 INFO  Executed sudo<install>, exit status 0, duration 23 secs
2022-02-14 09:23:25,499 DEBUG Process parameters for sudo<tedge_sub>
  command line : /usr/bin/sudo /usr/bin/tedge mqtt sub c8y/s/us
    arg #1     : /usr/bin/tedge
    arg #2     : mqtt
    arg #3     : sub
    arg #4     : c8y/s/us
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:23:25,507 INFO  Started sudo<tedge_sub> with process id 17369
2022-02-14 09:23:25,511 DEBUG Process parameters for sudo<tedge_pub>
  command line : /usr/bin/sudo /usr/bin/tedge mqtt pub c8y/s/ds 528,tedge,rolldice,,,delete
    arg #1     : /usr/bin/tedge
    arg #2     : mqtt
    arg #3     : pub
    arg #4     : c8y/s/ds
    arg #5     : 528,tedge,rolldice,,,delete
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_pub.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_pub.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:23:25,519 DEBUG Waiting up to 600 secs for process sudo<tedge_pub> (pid 17370)
2022-02-14 09:23:25,824 INFO  Executed sudo<tedge_pub>, exit status 0
2022-02-14 09:23:25,824 DEBUG --- test execute
2022-02-14 09:23:27,828 DEBUG Process parameters for sudo<sm_mapper_stop>
  command line : /usr/bin/sudo /usr/bin/systemctl stop tedge-mapper-sm-c8y.service
    arg #1     : /usr/bin/systemctl
    arg #2     : stop
    arg #3     : tedge-mapper-sm-c8y.service
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_stop.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_stop.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:23:27,834 DEBUG Waiting up to 600 secs for process sudo<sm_mapper_stop> (pid 17394)
2022-02-14 09:23:29,296 INFO  Executed sudo<sm_mapper_stop>, exit status 0
2022-02-14 09:23:29,297 DEBUG Process parameters for mosquitto_sub<tedge_sub_agent>
  command line : /usr/bin/mosquitto_sub -v -t tedge/commands/res/software/update
    arg #1     : -v
    arg #2     : -t
    arg #3     : tedge/commands/res/software/update
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub_agent.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub_agent.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:23:29,303 INFO  Started mosquitto_sub<tedge_sub_agent> with process id 17396
2022-02-14 09:23:44,322 DEBUG Process parameters for sudo<sm_mapper_restart>
  command line : /usr/bin/sudo /usr/bin/systemctl restart tedge-mapper-sm-c8y.service
    arg #1     : /usr/bin/systemctl
    arg #2     : restart
    arg #3     : tedge-mapper-sm-c8y.service
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_restart.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_restart.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:23:44,328 DEBUG Waiting up to 600 secs for process sudo<sm_mapper_restart> (pid 17397)
2022-02-14 09:23:44,683 INFO  Executed sudo<sm_mapper_restart>, exit status 0
2022-02-14 09:24:14,717 DEBUG Process parameters for sudo<kill_out>
  command line : /usr/bin/sudo killall tedge mosquitto_sub
    arg #1     : killall
    arg #2     : tedge
    arg #3     : mosquitto_sub
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/kill_out.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/kill_out.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:24:14,726 DEBUG Waiting up to 600 secs for process sudo<kill_out> (pid 17412)
2022-02-14 09:24:15,031 INFO  Executed sudo<kill_out>, exit status 0
2022-02-14 09:24:15,032 DEBUG --- test validate
2022-02-14 09:24:15,033 INFO  Validate
2022-02-14 09:24:15,034 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
2022-02-14 09:24:15,063 WARN  Grep on tedge_sub.out contains "501,c8y_SoftwareUpdate" ... failed [run.py:97]
2022-02-14 09:24:15,064 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
2022-02-14 09:24:15,076 WARN  Grep on tedge_sub.out contains "503,c8y_SoftwareUpdate" ... failed [run.py:98]
2022-02-14 09:24:15,080 DEBUG --- test cleanup
2022-02-14 09:24:15,081 INFO  
2022-02-14 09:24:15,081 INFO  cleanup:
2022-02-14 09:24:15,082 DEBUG Running registered cleanup function: <bound method SmMapperC8yReceiveLastMessageOnRestart.smcleanup of <SmMapperC8yReceiveLastMessageOnRestart object at 0x75c54350>>
2022-02-14 09:24:15,082 INFO  Stop sm-mapper and agent
2022-02-14 09:24:15,182 DEBUG Process parameters for sudo<tedge_disconnect_c8y>
  command line : /usr/bin/sudo /usr/bin/tedge disconnect c8y
    arg #1     : /usr/bin/tedge
    arg #2     : disconnect
    arg #3     : c8y
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_disconnect_c8y.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_disconnect_c8y.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 09:24:15,187 DEBUG Waiting up to 600 secs for process sudo<tedge_disconnect_c8y> (pid 17417)
2022-02-14 09:24:18,454 INFO  Executed sudo<tedge_disconnect_c8y>, exit status 0
2022-02-14 09:24:18,456 DEBUG ProcessUser cleanup function done.
2022-02-14 09:24:18,459 INFO  
2022-02-14 09:24:18,460 INFO  Test duration: 95.62 secs
2022-02-14 09:24:18,461 INFO  Test final outcome:  FAILED
2022-02-14 09:24:18,462 INFO  Test outcome reason: Grep on tedge_sub.out contains "501,c8y_SoftwareUpdate" (+1 other failures)
2022-02-14 09:24:18,463 INFO  
