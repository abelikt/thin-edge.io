2022-03-03 11:28:29,435 INFO  ==============================================================
2022-03-03 11:28:29,436 INFO  Id:    docker_plugin_update
2022-03-03 11:28:29,437 INFO  Dir:   plugin_docker/
2022-03-03 11:28:29,437 INFO  Title: Validate docker plugin install updates existing containers
2022-03-03 11:28:29,438 DEBUG Execution order hint: 0.0
2022-03-03 11:28:29,438 INFO  ==============================================================
2022-03-03 11:28:29,442 DEBUG Process parameters for sudo<docker_images>
  command line : /usr/bin/sudo docker images
    arg #1     : docker
    arg #2     : images
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_images.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_images.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:28:29,447 DEBUG Waiting up to 600 secs for process sudo<docker_images> (pid 20362)
2022-03-03 11:28:29,902 INFO  Executed sudo<docker_images>, exit status 0
2022-03-03 11:28:29,903 DEBUG Performing regex contains=False grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_images.out
2022-03-03 11:28:29,907 INFO  Grep on input file /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_images.out ... passed
2022-03-03 11:28:29,909 DEBUG Process parameters for sudo<docker_run>
  command line : /usr/bin/sudo docker run -d registry:2.6.2
    arg #1     : docker
    arg #2     : run
    arg #3     : -d
    arg #4     : registry:2.6.2
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_run.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_run.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:28:29,915 DEBUG Waiting up to 600 secs for process sudo<docker_run> (pid 20372)
2022-03-03 11:28:45,318 INFO  Executed sudo<docker_run>, exit status 0, duration 15 secs
2022-03-03 11:28:45,324 DEBUG Process parameters for sudo<docker_ps>
  command line : /usr/bin/sudo docker ps
    arg #1     : docker
    arg #2     : ps
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:28:45,328 DEBUG Waiting up to 600 secs for process sudo<docker_ps> (pid 20575)
2022-03-03 11:28:45,885 INFO  Executed sudo<docker_ps>, exit status 0
2022-03-03 11:28:45,886 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out
2022-03-03 11:28:45,891 DEBUG Grep on input file /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out successfully matched expression "registry:2.6.2" with line: '7c4450da5797        registry:2.6.2      "/entrypoint.sh /etc…"   2 seconds ago       Up Less than a second   5000/tcp            hardcore_lalande\n'
2022-03-03 11:28:45,892 INFO  Grep on input file /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out ... passed
2022-03-03 11:28:45,893 DEBUG --- test execute
2022-03-03 11:28:45,895 DEBUG Process parameters for sudo<plugin_install>
  command line : /usr/bin/sudo /etc/tedge/sm-plugins/docker install registry --module-version 2.7.1
    arg #1     : /etc/tedge/sm-plugins/docker
    arg #2     : install
    arg #3     : registry
    arg #4     : --module-version
    arg #5     : 2.7.1
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/plugin_install.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/plugin_install.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:28:45,901 DEBUG Waiting up to 600 secs for process sudo<plugin_install> (pid 20586)
2022-03-03 11:29:03,639 INFO  Executed sudo<plugin_install>, exit status 0, duration 17 secs
2022-03-03 11:29:03,645 DEBUG Process parameters for sudo<docker_ps_latest>
  command line : /usr/bin/sudo docker ps -q --latest
    arg #1     : docker
    arg #2     : ps
    arg #3     : -q
    arg #4     : --latest
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps_latest.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps_latest.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:29:03,650 DEBUG Waiting up to 600 secs for process sudo<docker_ps_latest> (pid 20871)
2022-03-03 11:29:04,104 INFO  Executed sudo<docker_ps_latest>, exit status 0
2022-03-03 11:29:04,107 DEBUG --- test validate
2022-03-03 11:29:04,108 DEBUG Process parameters for sudo<docker_ps>
  command line : /usr/bin/sudo docker ps
    arg #1     : docker
    arg #2     : ps
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:29:04,112 DEBUG Waiting up to 600 secs for process sudo<docker_ps> (pid 20881)
2022-03-03 11:29:04,567 INFO  Executed sudo<docker_ps>, exit status 0
2022-03-03 11:29:04,568 DEBUG Performing regex contains=False grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out
2022-03-03 11:29:04,571 INFO  Grep on input file /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out ... passed
2022-03-03 11:29:04,573 DEBUG Process parameters for sudo<docker_ps>
  command line : /usr/bin/sudo docker ps
    arg #1     : docker
    arg #2     : ps
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:29:04,578 DEBUG Waiting up to 600 secs for process sudo<docker_ps> (pid 20891)
2022-03-03 11:29:05,034 INFO  Executed sudo<docker_ps>, exit status 0
2022-03-03 11:29:05,035 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out
2022-03-03 11:29:05,038 DEBUG Grep on input file /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out successfully matched expression "registry:2.7.1" with line: '817f7364cc80        registry:2.7.1      "/entrypoint.sh /etc…"   3 seconds ago       Up 1 second         5000/tcp            eager_wu\n'
2022-03-03 11:29:05,039 INFO  Grep on input file /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/docker_ps.out ... passed
2022-03-03 11:29:05,044 DEBUG --- test cleanup
2022-03-03 11:29:05,045 INFO  
2022-03-03 11:29:05,046 INFO  cleanup:
2022-03-03 11:29:05,046 DEBUG Running registered cleanup function: <bound method DockerPlugin.cleanup_containers of <DockerPluginUpdateTest object at 0x7603f2d0>>
2022-03-03 11:29:05,047 INFO  Removing containers scheduled to be cleaned up: ['7124f6c8ffbd', '87ced66da336', 'fe0fe2f730a1929f5f81c6902f5e6a1fb0dc3f71e467c263334e0c85a0d52a77\n', '2901f3f3c24fb2daae95a75c9bd142e153cab398e915add8233b578034dd5741\n', '7c4450da5797dbb09411920eb99538a8c3e9fe8227e6abe9047c3d0a5d82c0ad\n', '817f7364cc80']
2022-03-03 11:29:05,049 DEBUG Process parameters for sudo<containers_for_cleanup>
  command line : /usr/bin/sudo docker rm -f 7124f6c8ffbd 87ced66da336 'fe0fe2f730a1929f5f81c6902f5e6a1fb0dc3f71e467c263334e0c85a0d52a77
' '2901f3f3c24fb2daae95a75c9bd142e153cab398e915add8233b578034dd5741
' '7c4450da5797dbb09411920eb99538a8c3e9fe8227e6abe9047c3d0a5d82c0ad
' 817f7364cc80
    arg #1     : docker
    arg #2     : rm
    arg #3     : -f
    arg #4     : 7124f6c8ffbd
    arg #5     : 87ced66da336
    arg #6     : fe0fe2f730a1929f5f81c6902f5e6a1fb0dc3f71e467c263334e0c85a0d52a77

    arg #7     : 2901f3f3c24fb2daae95a75c9bd142e153cab398e915add8233b578034dd5741

    arg #8     : 7c4450da5797dbb09411920eb99538a8c3e9fe8227e6abe9047c3d0a5d82c0ad

    arg #9     : 817f7364cc80
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/containers_for_cleanup.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/containers_for_cleanup.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:29:05,055 DEBUG Waiting up to 600 secs for process sudo<containers_for_cleanup> (pid 20901)
2022-03-03 11:29:07,026 WARN  Executed sudo<containers_for_cleanup>, exit status 1
2022-03-03 11:29:07,027 DEBUG Running registered cleanup function: <bound method DockerPlugin.cleanup_images of <DockerPluginUpdateTest object at 0x7603f2d0>>
2022-03-03 11:29:07,028 INFO  Removing images scheduled to be cleaned up: ['registry', 'registry', 'registry:2.7.1', 'registry', 'registry:2.7.1', 'registry:2.6.2', 'registry:2.7.1']
2022-03-03 11:29:07,030 DEBUG Process parameters for sudo<containers_for_cleanup>
  command line : /usr/bin/sudo docker rmi -f registry registry registry:2.7.1 registry registry:2.7.1 registry:2.6.2 registry:2.7.1
    arg #1     : docker
    arg #2     : rmi
    arg #3     : -f
    arg #4     : registry
    arg #5     : registry
    arg #6     : registry:2.7.1
    arg #7     : registry
    arg #8     : registry:2.7.1
    arg #9     : registry:2.6.2
    arg #10    : registry:2.7.1
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/containers_for_cleanup.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/plugin_docker/docker_plugin_update/Output/linux/containers_for_cleanup.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-03-03 11:29:07,037 DEBUG Waiting up to 600 secs for process sudo<containers_for_cleanup> (pid 20954)
2022-03-03 11:29:11,261 INFO  Executed sudo<containers_for_cleanup>, exit status 0
2022-03-03 11:29:11,262 DEBUG ProcessUser cleanup function done.
2022-03-03 11:29:11,265 INFO  
2022-03-03 11:29:11,266 INFO  Test duration: 41.83 secs
2022-03-03 11:29:11,267 INFO  Test final outcome:  PASSED
2022-03-03 11:29:11,268 INFO  
