2022-02-15 19:32:55,566 INFO  ==============================================================
2022-02-15 19:32:55,566 INFO  Id:    SoftwareManagement.sm_mapper_fail_and_reconnect
2022-02-15 19:32:55,567 INFO  Dir:   software_management_end_to_end/
2022-02-15 19:32:55,568 INFO  Title: Validate the tedge-mapper-sm-c8y for receiving the last message on restart
2022-02-15 19:32:55,568 DEBUG Execution order hint: 0.0
2022-02-15 19:32:55,569 INFO  ==============================================================
2022-02-15 19:32:55,635 INFO  Restarting mosquitto too frequently in the last 10 seconds. It was only up for 4 seconds
2022-02-15 19:32:55,636 INFO  Delaying execution by 7 seconds
2022-02-15 19:33:02,645 DEBUG Process parameters for sudo<tedge_connect_c8y>
  command line : /usr/bin/sudo /usr/bin/tedge connect c8y
    arg #1     : /usr/bin/tedge
    arg #2     : connect
    arg #3     : c8y
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_connect_c8y.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_connect_c8y.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:33:02,651 DEBUG Waiting up to 600 secs for process sudo<tedge_connect_c8y> (pid 9966)
2022-02-15 19:33:14,936 INFO  Executed sudo<tedge_connect_c8y>, exit status 0, duration 12 secs
2022-02-15 19:33:14,938 DEBUG Process parameters for sudo<install>
  command line : /usr/bin/sudo /usr/bin/apt-get install rolldice
    arg #1     : /usr/bin/apt-get
    arg #2     : install
    arg #3     : rolldice
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/install.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/install.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:33:14,944 DEBUG Waiting up to 600 secs for process sudo<install> (pid 10170)
2022-02-15 19:33:18,264 INFO  Executed sudo<install>, exit status 0
2022-02-15 19:33:18,266 DEBUG Process parameters for sudo<tedge_sub>
  command line : /usr/bin/sudo /usr/bin/tedge mqtt sub c8y/s/us
    arg #1     : /usr/bin/tedge
    arg #2     : mqtt
    arg #3     : sub
    arg #4     : c8y/s/us
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:33:18,272 INFO  Started sudo<tedge_sub> with process id 10195
2022-02-15 19:33:18,275 DEBUG Process parameters for sudo<tedge_pub>
  command line : /usr/bin/sudo /usr/bin/tedge mqtt pub c8y/s/ds 528,tedge,rolldice,,,delete
    arg #1     : /usr/bin/tedge
    arg #2     : mqtt
    arg #3     : pub
    arg #4     : c8y/s/ds
    arg #5     : 528,tedge,rolldice,,,delete
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_pub.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_pub.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:33:18,301 DEBUG Waiting up to 600 secs for process sudo<tedge_pub> (pid 10196)
2022-02-15 19:33:18,672 INFO  Executed sudo<tedge_pub>, exit status 0
2022-02-15 19:33:18,673 DEBUG --- test execute
2022-02-15 19:33:20,677 DEBUG Process parameters for sudo<sm_mapper_stop>
  command line : /usr/bin/sudo /usr/bin/systemctl stop tedge-mapper-sm-c8y.service
    arg #1     : /usr/bin/systemctl
    arg #2     : stop
    arg #3     : tedge-mapper-sm-c8y.service
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_stop.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_stop.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:33:20,682 DEBUG Waiting up to 600 secs for process sudo<sm_mapper_stop> (pid 10228)
2022-02-15 19:33:21,037 INFO  Executed sudo<sm_mapper_stop>, exit status 0
2022-02-15 19:33:21,039 DEBUG Process parameters for mosquitto_sub<tedge_sub_agent>
  command line : /usr/bin/mosquitto_sub -v -t tedge/commands/res/software/update
    arg #1     : -v
    arg #2     : -t
    arg #3     : tedge/commands/res/software/update
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub_agent.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub_agent.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:33:21,044 INFO  Started mosquitto_sub<tedge_sub_agent> with process id 10241
2022-02-15 19:33:36,062 DEBUG Process parameters for sudo<sm_mapper_restart>
  command line : /usr/bin/sudo /usr/bin/systemctl restart tedge-mapper-sm-c8y.service
    arg #1     : /usr/bin/systemctl
    arg #2     : restart
    arg #3     : tedge-mapper-sm-c8y.service
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_restart.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_restart.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:33:36,068 DEBUG Waiting up to 600 secs for process sudo<sm_mapper_restart> (pid 10302)
2022-02-15 19:33:36,322 INFO  Executed sudo<sm_mapper_restart>, exit status 0
2022-02-15 19:34:06,338 DEBUG Process parameters for sudo<kill_out>
  command line : /usr/bin/sudo killall tedge mosquitto_sub
    arg #1     : killall
    arg #2     : tedge
    arg #3     : mosquitto_sub
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/kill_out.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/kill_out.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:34:06,344 DEBUG Waiting up to 600 secs for process sudo<kill_out> (pid 10430)
2022-02-15 19:34:06,598 INFO  Executed sudo<kill_out>, exit status 0
2022-02-15 19:34:06,599 DEBUG --- test validate
2022-02-15 19:34:06,599 INFO  Validate
2022-02-15 19:34:06,600 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
2022-02-15 19:34:06,612 DEBUG Grep on input file tedge_sub.out successfully matched expression "501,c8y_SoftwareUpdate" with line: '[c8y/s/us] 501,c8y_SoftwareUpdate\n'
2022-02-15 19:34:06,612 INFO  Grep on input file tedge_sub.out ... passed
2022-02-15 19:34:06,613 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
2022-02-15 19:34:06,840 WARN  Grep on tedge_sub.out contains "503,c8y_SoftwareUpdate" ... failed [run.py:98]
2022-02-15 19:34:06,842 DEBUG --- test cleanup
2022-02-15 19:34:06,843 INFO  
2022-02-15 19:34:06,844 INFO  cleanup:
2022-02-15 19:34:06,844 DEBUG Running registered cleanup function: <bound method SmMapperC8yReceiveLastMessageOnRestart.smcleanup of <SmMapperC8yReceiveLastMessageOnRestart object at 0x7561a030>>
2022-02-15 19:34:06,844 INFO  Stop sm-mapper and agent
2022-02-15 19:34:06,952 DEBUG Process parameters for sudo<tedge_disconnect_c8y>
  command line : /usr/bin/sudo /usr/bin/tedge disconnect c8y
    arg #1     : /usr/bin/tedge
    arg #2     : disconnect
    arg #3     : c8y
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_disconnect_c8y.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_disconnect_c8y.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-15 19:34:06,958 DEBUG Waiting up to 600 secs for process sudo<tedge_disconnect_c8y> (pid 10435)
2022-02-15 19:34:10,589 INFO  Executed sudo<tedge_disconnect_c8y>, exit status 0
2022-02-15 19:34:10,590 DEBUG ProcessUser cleanup function done.
2022-02-15 19:34:10,592 INFO  
2022-02-15 19:34:10,593 INFO  Test duration: 75.03 secs
2022-02-15 19:34:10,593 INFO  Test final outcome:  FAILED
2022-02-15 19:34:10,594 INFO  Test outcome reason: Grep on tedge_sub.out contains "503,c8y_SoftwareUpdate"
2022-02-15 19:34:10,594 INFO  
