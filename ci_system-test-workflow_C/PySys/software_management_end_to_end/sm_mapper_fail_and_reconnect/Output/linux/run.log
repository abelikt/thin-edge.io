2022-02-07 14:50:24,653 INFO  ==============================================================
2022-02-07 14:50:24,653 INFO  Id:    SoftwareManagement.sm_mapper_fail_and_reconnect
2022-02-07 14:50:24,654 INFO  Dir:   software_management_end_to_end/
2022-02-07 14:50:24,655 INFO  Title: Validate the tedge-mapper-sm-c8y for receiving the last message on restart
2022-02-07 14:50:24,655 DEBUG Execution order hint: 0.0
2022-02-07 14:50:24,655 INFO  ==============================================================
2022-02-07 14:50:24,750 INFO  Restarting mosquitto too frequently in the last 10 seconds. It was only up for 3 seconds
2022-02-07 14:50:24,751 INFO  Delaying execution by 8 seconds
2022-02-07 14:50:32,763 DEBUG Process parameters for sudo<tedge_connect_c8y>
  command line : /usr/bin/sudo /usr/bin/tedge connect c8y
    arg #1     : /usr/bin/tedge
    arg #2     : connect
    arg #3     : c8y
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_connect_c8y.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_connect_c8y.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:50:32,772 DEBUG Waiting up to 600 secs for process sudo<tedge_connect_c8y> (pid 6318)
2022-02-07 14:50:44,129 INFO  Executed sudo<tedge_connect_c8y>, exit status 0, duration 11 secs
2022-02-07 14:50:44,137 DEBUG Process parameters for sudo<install>
  command line : /usr/bin/sudo /usr/bin/apt-get install rolldice
    arg #1     : /usr/bin/apt-get
    arg #2     : install
    arg #3     : rolldice
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/install.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/install.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:50:44,145 DEBUG Waiting up to 600 secs for process sudo<install> (pid 6471)
2022-02-07 14:51:08,032 INFO  Executed sudo<install>, exit status 0, duration 23 secs
2022-02-07 14:51:08,035 DEBUG Process parameters for sudo<tedge_sub>
  command line : /usr/bin/sudo /usr/bin/tedge mqtt sub c8y/s/us
    arg #1     : /usr/bin/tedge
    arg #2     : mqtt
    arg #3     : sub
    arg #4     : c8y/s/us
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:51:08,042 INFO  Started sudo<tedge_sub> with process id 6637
2022-02-07 14:51:08,047 DEBUG Process parameters for sudo<tedge_pub>
  command line : /usr/bin/sudo /usr/bin/tedge mqtt pub c8y/s/ds 528,tedge,rolldice,,,delete
    arg #1     : /usr/bin/tedge
    arg #2     : mqtt
    arg #3     : pub
    arg #4     : c8y/s/ds
    arg #5     : 528,tedge,rolldice,,,delete
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_pub.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_pub.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:51:08,054 DEBUG Waiting up to 600 secs for process sudo<tedge_pub> (pid 6638)
2022-02-07 14:51:08,359 INFO  Executed sudo<tedge_pub>, exit status 0
2022-02-07 14:51:08,360 DEBUG --- test execute
2022-02-07 14:51:10,362 DEBUG Process parameters for sudo<sm_mapper_stop>
  command line : /usr/bin/sudo /usr/bin/systemctl stop tedge-mapper-sm-c8y.service
    arg #1     : /usr/bin/systemctl
    arg #2     : stop
    arg #3     : tedge-mapper-sm-c8y.service
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_stop.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_stop.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:51:10,368 DEBUG Waiting up to 600 secs for process sudo<sm_mapper_stop> (pid 6649)
2022-02-07 14:51:11,427 INFO  Executed sudo<sm_mapper_stop>, exit status 0
2022-02-07 14:51:11,428 DEBUG Process parameters for mosquitto_sub<tedge_sub_agent>
  command line : /usr/bin/mosquitto_sub -v -t tedge/commands/res/software/update
    arg #1     : -v
    arg #2     : -t
    arg #3     : tedge/commands/res/software/update
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub_agent.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub_agent.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:51:11,433 INFO  Started mosquitto_sub<tedge_sub_agent> with process id 6651
2022-02-07 14:51:26,452 DEBUG Process parameters for sudo<sm_mapper_restart>
  command line : /usr/bin/sudo /usr/bin/systemctl restart tedge-mapper-sm-c8y.service
    arg #1     : /usr/bin/systemctl
    arg #2     : restart
    arg #3     : tedge-mapper-sm-c8y.service
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_restart.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_restart.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:51:26,457 DEBUG Waiting up to 600 secs for process sudo<sm_mapper_restart> (pid 6655)
2022-02-07 14:51:26,962 INFO  Executed sudo<sm_mapper_restart>, exit status 0
2022-02-07 14:51:57,000 DEBUG Process parameters for sudo<kill_out>
  command line : /usr/bin/sudo killall tedge mosquitto_sub
    arg #1     : killall
    arg #2     : tedge
    arg #3     : mosquitto_sub
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/kill_out.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/kill_out.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:51:57,005 DEBUG Waiting up to 600 secs for process sudo<kill_out> (pid 6681)
2022-02-07 14:51:57,310 INFO  Executed sudo<kill_out>, exit status 0
2022-02-07 14:51:57,311 DEBUG --- test validate
2022-02-07 14:51:57,312 INFO  Validate
2022-02-07 14:51:57,312 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
2022-02-07 14:51:57,343 WARN  Grep on tedge_sub.out contains "501,c8y_SoftwareUpdate" ... failed [run.py:97]
2022-02-07 14:51:57,344 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
2022-02-07 14:51:57,357 WARN  Grep on tedge_sub.out contains "503,c8y_SoftwareUpdate" ... failed [run.py:98]
2022-02-07 14:51:57,362 DEBUG --- test cleanup
2022-02-07 14:51:57,362 INFO  
2022-02-07 14:51:57,363 INFO  cleanup:
2022-02-07 14:51:57,363 DEBUG Running registered cleanup function: <bound method SmMapperC8yReceiveLastMessageOnRestart.smcleanup of <SmMapperC8yReceiveLastMessageOnRestart object at 0x766ae950>>
2022-02-07 14:51:57,363 INFO  Stop sm-mapper and agent
2022-02-07 14:51:57,464 DEBUG Process parameters for sudo<tedge_disconnect_c8y>
  command line : /usr/bin/sudo /usr/bin/tedge disconnect c8y
    arg #1     : /usr/bin/tedge
    arg #2     : disconnect
    arg #3     : c8y
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_disconnect_c8y.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_disconnect_c8y.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-07 14:51:57,469 DEBUG Waiting up to 600 secs for process sudo<tedge_disconnect_c8y> (pid 6686)
2022-02-07 14:52:00,586 INFO  Executed sudo<tedge_disconnect_c8y>, exit status 0
2022-02-07 14:52:00,588 DEBUG ProcessUser cleanup function done.
2022-02-07 14:52:00,591 INFO  
2022-02-07 14:52:00,591 INFO  Test duration: 95.95 secs
2022-02-07 14:52:00,592 INFO  Test final outcome:  FAILED
2022-02-07 14:52:00,593 INFO  Test outcome reason: Grep on tedge_sub.out contains "501,c8y_SoftwareUpdate" (+1 other failures)
2022-02-07 14:52:00,594 INFO  
