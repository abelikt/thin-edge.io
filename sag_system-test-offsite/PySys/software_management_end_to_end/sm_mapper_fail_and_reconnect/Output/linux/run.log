2022-02-14 14:19:18,617 INFO  ==============================================================
2022-02-14 14:19:18,618 INFO  Id:    SoftwareManagement.sm_mapper_fail_and_reconnect
2022-02-14 14:19:18,618 INFO  Dir:   software_management_end_to_end/
2022-02-14 14:19:18,619 INFO  Title: Validate the tedge-mapper-sm-c8y for receiving the last message on restart
2022-02-14 14:19:18,619 DEBUG Execution order hint: 0.0
2022-02-14 14:19:18,620 INFO  ==============================================================
2022-02-14 14:19:18,710 INFO  Restarting mosquitto too frequently in the last 10 seconds. It was only up for 3 seconds
2022-02-14 14:19:18,711 INFO  Delaying execution by 8 seconds
2022-02-14 14:19:26,723 DEBUG Process parameters for sudo<tedge_connect_c8y>
  command line : /usr/bin/sudo /usr/bin/tedge connect c8y
    arg #1     : /usr/bin/tedge
    arg #2     : connect
    arg #3     : c8y
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_connect_c8y.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_connect_c8y.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:19:26,732 DEBUG Waiting up to 600 secs for process sudo<tedge_connect_c8y> (pid 12328)
2022-02-14 14:19:37,682 INFO  Executed sudo<tedge_connect_c8y>, exit status 0
2022-02-14 14:19:37,685 DEBUG Process parameters for sudo<install>
  command line : /usr/bin/sudo /usr/bin/apt-get install rolldice
    arg #1     : /usr/bin/apt-get
    arg #2     : install
    arg #3     : rolldice
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/install.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/install.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:19:37,690 DEBUG Waiting up to 600 secs for process sudo<install> (pid 12463)
2022-02-14 14:20:03,933 INFO  Executed sudo<install>, exit status 0, duration 26 secs
2022-02-14 14:20:03,936 DEBUG Process parameters for sudo<tedge_sub>
  command line : /usr/bin/sudo /usr/bin/tedge mqtt sub c8y/s/us
    arg #1     : /usr/bin/tedge
    arg #2     : mqtt
    arg #3     : sub
    arg #4     : c8y/s/us
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:20:03,944 INFO  Started sudo<tedge_sub> with process id 12614
2022-02-14 14:20:03,950 DEBUG Process parameters for sudo<tedge_pub>
  command line : /usr/bin/sudo /usr/bin/tedge mqtt pub c8y/s/ds 528,tedge,rolldice,,,delete
    arg #1     : /usr/bin/tedge
    arg #2     : mqtt
    arg #3     : pub
    arg #4     : c8y/s/ds
    arg #5     : 528,tedge,rolldice,,,delete
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_pub.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_pub.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:20:03,956 DEBUG Waiting up to 600 secs for process sudo<tedge_pub> (pid 12615)
2022-02-14 14:20:04,260 INFO  Executed sudo<tedge_pub>, exit status 0
2022-02-14 14:20:04,261 DEBUG --- test execute
2022-02-14 14:20:06,265 DEBUG Process parameters for sudo<sm_mapper_stop>
  command line : /usr/bin/sudo /usr/bin/systemctl stop tedge-mapper-sm-c8y.service
    arg #1     : /usr/bin/systemctl
    arg #2     : stop
    arg #3     : tedge-mapper-sm-c8y.service
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_stop.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_stop.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:20:06,273 DEBUG Waiting up to 600 secs for process sudo<sm_mapper_stop> (pid 12630)
2022-02-14 14:20:07,404 INFO  Executed sudo<sm_mapper_stop>, exit status 0
2022-02-14 14:20:07,406 DEBUG Process parameters for mosquitto_sub<tedge_sub_agent>
  command line : /usr/bin/mosquitto_sub -v -t tedge/commands/res/software/update
    arg #1     : -v
    arg #2     : -t
    arg #3     : tedge/commands/res/software/update
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub_agent.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub_agent.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:20:07,411 INFO  Started mosquitto_sub<tedge_sub_agent> with process id 12632
2022-02-14 14:20:22,431 DEBUG Process parameters for sudo<sm_mapper_restart>
  command line : /usr/bin/sudo /usr/bin/systemctl restart tedge-mapper-sm-c8y.service
    arg #1     : /usr/bin/systemctl
    arg #2     : restart
    arg #3     : tedge-mapper-sm-c8y.service
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_restart.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/sm_mapper_restart.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:20:22,441 DEBUG Waiting up to 600 secs for process sudo<sm_mapper_restart> (pid 12634)
2022-02-14 14:20:22,798 INFO  Executed sudo<sm_mapper_restart>, exit status 0
2022-02-14 14:20:52,835 DEBUG Process parameters for sudo<kill_out>
  command line : /usr/bin/sudo killall tedge mosquitto_sub
    arg #1     : killall
    arg #2     : tedge
    arg #3     : mosquitto_sub
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/kill_out.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/kill_out.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:20:52,843 DEBUG Waiting up to 600 secs for process sudo<kill_out> (pid 12644)
2022-02-14 14:20:53,148 INFO  Executed sudo<kill_out>, exit status 0
2022-02-14 14:20:53,149 DEBUG --- test validate
2022-02-14 14:20:53,149 INFO  Validate
2022-02-14 14:20:53,150 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
2022-02-14 14:20:53,179 WARN  Grep on tedge_sub.out contains "501,c8y_SoftwareUpdate" ... failed [run.py:97]
2022-02-14 14:20:53,180 DEBUG Performing regex contains=True grep on file: /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_sub.out
2022-02-14 14:20:53,193 WARN  Grep on tedge_sub.out contains "503,c8y_SoftwareUpdate" ... failed [run.py:98]
2022-02-14 14:20:53,198 DEBUG --- test cleanup
2022-02-14 14:20:53,199 INFO  
2022-02-14 14:20:53,199 INFO  cleanup:
2022-02-14 14:20:53,199 DEBUG Running registered cleanup function: <bound method SmMapperC8yReceiveLastMessageOnRestart.smcleanup of <SmMapperC8yReceiveLastMessageOnRestart object at 0x760b7a30>>
2022-02-14 14:20:53,200 INFO  Stop sm-mapper and agent
2022-02-14 14:20:53,295 DEBUG Process parameters for sudo<tedge_disconnect_c8y>
  command line : /usr/bin/sudo /usr/bin/tedge disconnect c8y
    arg #1     : /usr/bin/tedge
    arg #2     : disconnect
    arg #3     : c8y
  working dir  : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux
  stdout       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_disconnect_c8y.out
  stderr       : /home/pi/actions-runner/_work/thin-edge.io/thin-edge.io/tests/PySys/software_management_end_to_end/sm_mapper_fail_and_reconnect/Output/linux/tedge_disconnect_c8y.err
  environment  : LD_LIBRARY_PATH=/usr/lib
  environment  : PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin
                   #1  /bin
                   #2  /usr/bin
                   #3  /usr/sbin
                   #4  /usr/local/bin
2022-02-14 14:20:53,301 DEBUG Waiting up to 600 secs for process sudo<tedge_disconnect_c8y> (pid 12649)
2022-02-14 14:20:56,327 INFO  Executed sudo<tedge_disconnect_c8y>, exit status 0
2022-02-14 14:20:56,329 DEBUG ProcessUser cleanup function done.
2022-02-14 14:20:56,332 INFO  
2022-02-14 14:20:56,332 INFO  Test duration: 97.72 secs
2022-02-14 14:20:56,333 INFO  Test final outcome:  FAILED
2022-02-14 14:20:56,334 INFO  Test outcome reason: Grep on tedge_sub.out contains "501,c8y_SoftwareUpdate" (+1 other failures)
2022-02-14 14:20:56,335 INFO  
